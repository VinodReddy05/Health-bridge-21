import{r as a,u as N,j as e,L as w}from"./index-C8N-Qaqw.js";import{s as L}from"./SupaBase-hXybzm9P.js";const T=()=>{const[g,u]=a.useState(!1),[o,p]=a.useState(""),[r,h]=a.useState(""),[t,x]=a.useState("patient"),[j,m]=a.useState(!1),[f,i]=a.useState(!1),[v,l]=a.useState(""),n=N();a.useEffect(()=>{const s=localStorage.getItem("userRole");s&&(s==="admin"?n("/admin"):(s==="patient"||s==="doctor")&&n("/"))},[n]);const b=async s=>{s.preventDefault(),u(!0),m(!0);try{if(o==="admin@gmail.com"&&r==="123456"){l("Admin Login Successful"),i(!0),setTimeout(()=>{localStorage.setItem("userRole","admin"),n("/")},1500);return}const y=t==="patient"?"patientsdata":"DoctorsData",{data:c,error:d}=await L.from(y).select("*",{headers:{Accept:"application/json"}}).eq("email_id",o).eq("password",r).single();if(d&&d.code!=="PGRST116")throw d;if(c){l(`${t==="patient"?"Patient":"Doctor"} Login Successful`),i(!0),setTimeout(()=>{localStorage.setItem("userRole",t),localStorage.setItem(`${t}Data`,JSON.stringify({userId:c.id,...c})),n(t==="patient"?"/":"/doctor/dashboard")},1500);return}l("Invalid Credentials"),i(!0),setTimeout(()=>i(!1),1500)}catch{l("Invalid Credentials"),i(!0),setTimeout(()=>i(!1),1500)}finally{u(!1),m(!1)}};return e.jsxs("div",{className:"login-container",children:[g||j?e.jsx("div",{className:"blur-background"}):null,f&&e.jsxs("div",{className:"gif-container",children:[e.jsx("img",{src:"https://media.giphy.com/media/swhRkVYLJDrCE/giphy.gif?cid=ecf05e47l2mubft6j3ziu9t1qbgvfkfngodcfrx0efthlwlz&ep=v1_gifs_search&rid=giphy.gif&ct=g",alt:"Loading..."}),e.jsx("p",{children:v})]}),e.jsxs("div",{className:`login ${f?"hidden":""}`,children:[e.jsx("h2",{children:t==="patient"?"Patient Login":"Doctor Login"}),e.jsxs("form",{className:"login-form",onSubmit:b,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"User Type"}),e.jsxs("select",{className:"form-input",value:t,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"patient",children:"Patient"}),e.jsx("option",{value:"doctor",children:"Doctor"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input",value:o,onChange:s=>p(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-input",value:r,onChange:s=>h(s.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"submit-button",children:"Login"})]}),t==="patient"&&e.jsxs("p",{children:["Creat a new account  ",e.jsx(w,{to:"/signup",children:"Go to Signup"})]})]})]})};export{T as default};
